---
title: "I'll think of a better title later"
output: html_document
editor_options: 
  chunk_output_type: console
---

by Ruochen Wang

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = T)

```

```{r load-packages-and-set-wd, echo = T, message = F}
library(tidyverse)
library(readxl)
library(treemapify)
library(extrafont)

setwd("~/Downloads/DataScienceAssignments/dataviz-project")

```


```{r make-bar, echo = T}

data_bar <-
  read_excel("data/bar-pov_rate.xls")

ggplot() +
  geom_col(data = data_bar,
           mapping = aes(x = reorder(ed_level, -pct),
                         y = pct),
           fill = "#fdbe85",
           color = "#fdbe85",
           width = .7) +
  geom_hline(yintercept = 11.4697, size = .7, linetype = "dashed", color = "#8c2d04") +
  scale_y_continuous(breaks = c(0, 5, 10, 15, 20, 25)) +
  labs(title = "In the United States, high school dropouts are almost twice as likely to\nexperience poverty as their peers with a high school diploma",
       subtitle = "Percent of US Population Ages 25 and Old living below poverty level in the Past 12 Months, 2017",
       caption = "* Dashed line denotes national average.\nSource: 2017 American Community Survey 5-Year Estimates, US Census Bureau",
       y = "%") +
  theme_minimal() +
  theme(plot.margin = unit(c(1,1,1,1),"cm"),
        plot.title = element_text(size = 12, family = "Arial", face = "bold", vjust = 3),
        plot.subtitle = element_text(size = 9, family = "Arial", vjust = 3),
        plot.caption = element_text(size = 7, family = "Arial", vjust = -2, hjust = 0),
        axis.title.x = element_blank(),
        axis.title.y = element_text(angle = 0, family = "Arial", vjust = .5),
        axis.text.x = element_text(angle = 45, vjust = 1.1, hjust = 1, family = "Arial"),
        axis.text.y = element_text(family = "Arial"),
        axis.ticks.x = element_blank(),
        axis.ticks.y = element_blank(),
        panel.background = element_blank(),
        panel.grid.minor.y = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank())

```


```{r make-treemap, echo = T}

data_treemap <-
  read_excel("data/treemap-snap_and_poverty_rate.xlsx")

ggplot(data = data_treemap,
       mapping = aes(area = est_num_hh_snap,
                     fill = est_pct_hh_poor,
                     label = state,
                     subgroup = census_region)) +
  geom_treemap() +
  geom_treemap_subgroup_border(color = "white") +
  geom_treemap_text(color = "white",
                    place = "center",
                    grow = F,
                    reflow = T) +
  geom_treemap_subgroup_text(color = "#FAFAFA",
                             place = "center",
                             grow = T,
                             alpha = .5,
                             min.size = 0) +
  scale_fill_gradient(low = "#c6dbef", high = "#08306b",
                      limits = c(5, 25),
                      breaks = seq(5, 25, by = 5),
                      name = "% of Households Experienced\nPoverty in the Past 12 Months") +
  labs(title = "Number of Households Receiving SNAP Benefits, 2017",
       subtitle = "Southern states, where poverty is the most concentrated among census regions, held the\nmost families receiving food stamps in 2017.",
       caption = "Source: 2017 American Community Survey 5-Year Estimates, US Census Bureau") +
  theme(plot.margin = unit(c(1,1,1,1),"cm"),
        plot.title = element_text(size = 14, family = "Arial", face = "bold", vjust = 2),
        plot.subtitle = element_text(size = 9, family = "Arial", vjust = 2),
        plot.caption = element_text(size = 7, family = "Arial", vjust = -2, hjust = 0),
        legend.title = element_text(size = 7, family = "Arial", vjust = 4),
        legend.text = element_text(size = 7, family = "Arial"))

```
